var DD_belatedPNG={ns:"DD_belatedPNG",imgSize:{},delay:10,nodesFixed:0,createVmlNameSpace:function(){document.namespaces&&!document.namespaces[this.ns]&&document.namespaces.add(this.ns,"urn:schemas-microsoft-com:vml")},createVmlStyleSheet:function(){var screenStyleSheet,printStyleSheet;screenStyleSheet=document.createElement("style"),screenStyleSheet.setAttribute("media","screen"),document.documentElement.firstChild.insertBefore(screenStyleSheet,document.documentElement.firstChild.firstChild),screenStyleSheet.styleSheet&&(screenStyleSheet=screenStyleSheet.styleSheet,screenStyleSheet.addRule(this.ns+"\\:*","{behavior:url(#default#VML)}"),screenStyleSheet.addRule(this.ns+"\\:shape","position:absolute;"),screenStyleSheet.addRule("img."+this.ns+"_sizeFinder","behavior:none; border:none; position:absolute; z-index:-1; top:-10000px; visibility:hidden;"),this.screenStyleSheet=screenStyleSheet,printStyleSheet=document.createElement("style"),printStyleSheet.setAttribute("media","print"),document.documentElement.firstChild.insertBefore(printStyleSheet,document.documentElement.firstChild.firstChild),printStyleSheet=printStyleSheet.styleSheet,printStyleSheet.addRule(this.ns+"\\:*","{display: none !important;}"),printStyleSheet.addRule("img."+this.ns+"_sizeFinder","{display: none !important;}"))},readPropertyChange:function(){var el,display,v;if(el=event.srcElement,el.vmlInitiated){if((-1!=event.propertyName.search("background")||-1!=event.propertyName.search("border"))&&DD_belatedPNG.applyVML(el),"style.display"==event.propertyName){display="none"==el.currentStyle.display?"none":"block";for(v in el.vml)el.vml.hasOwnProperty(v)&&(el.vml[v].shape.style.display=display)}-1!=event.propertyName.search("filter")&&DD_belatedPNG.vmlOpacity(el)}},vmlOpacity:function(el){if(-1!=el.currentStyle.filter.search("lpha")){var trans=el.currentStyle.filter;trans=parseInt(trans.substring(trans.lastIndexOf("=")+1,trans.lastIndexOf(")")),10)/100,el.vml.color.shape.style.filter=el.currentStyle.filter,el.vml.image.fill.opacity=trans}},handlePseudoHover:function(el){setTimeout(function(){DD_belatedPNG.applyVML(el)},1)},fix:function(selector){if(this.screenStyleSheet){var selectors,i;for(selectors=selector.split(","),i=0;i<selectors.length;i++)this.screenStyleSheet.addRule(selectors[i],"behavior:expression(DD_belatedPNG.fixPng(this))")}},applyVML:function(el){el.runtimeStyle.cssText="",this.vmlFill(el),this.vmlOffsets(el),this.vmlOpacity(el),el.isImg&&this.copyImageBorders(el)},attachHandlers:function(el){var self,handlers,handler,moreForAs,a,h;if(self=this,handlers={resize:"vmlOffsets",move:"vmlOffsets"},"A"==el.nodeName){moreForAs={mouseleave:"handlePseudoHover",mouseenter:"handlePseudoHover",focus:"handlePseudoHover",blur:"handlePseudoHover"};for(a in moreForAs)moreForAs.hasOwnProperty(a)&&(handlers[a]=moreForAs[a])}for(h in handlers)handlers.hasOwnProperty(h)&&(handler=function(){self[handlers[h]](el)},el.attachEvent("on"+h,handler));el.attachEvent("onpropertychange",this.readPropertyChange)},giveLayout:function(el){el.style.zoom=1,"static"==el.currentStyle.position&&(el.style.position="relative")},copyImageBorders:function(el){var styles,s;styles={borderStyle:!0,borderWidth:!0,borderColor:!0};for(s in styles)styles.hasOwnProperty(s)&&(el.vml.color.shape.style[s]=el.currentStyle[s])},vmlFill:function(el){if(el.currentStyle){var elStyle,noImg,lib,v,img,imgLoaded;elStyle=el.currentStyle;for(v in el.vml)el.vml.hasOwnProperty(v)&&(el.vml[v].shape.style.zIndex=elStyle.zIndex);el.runtimeStyle.backgroundColor="",el.runtimeStyle.backgroundImage="",noImg=!0,("none"!=elStyle.backgroundImage||el.isImg)&&(el.isImg?el.vmlBg=el.src:(el.vmlBg=elStyle.backgroundImage,el.vmlBg=el.vmlBg.substr(5,el.vmlBg.lastIndexOf('")')-5)),lib=this,lib.imgSize[el.vmlBg]||(img=document.createElement("img"),lib.imgSize[el.vmlBg]=img,img.className=lib.ns+"_sizeFinder",img.runtimeStyle.cssText="behavior:none; position:absolute; left:-10000px; top:-10000px; border:none; margin:0; padding:0;",imgLoaded=function(){this.width=this.offsetWidth,this.height=this.offsetHeight,lib.vmlOffsets(el)},img.attachEvent("onload",imgLoaded),img.src=el.vmlBg,img.removeAttribute("width"),img.removeAttribute("height"),document.body.insertBefore(img,document.body.firstChild)),el.vml.image.fill.src=el.vmlBg,noImg=!1),el.vml.image.fill.on=!noImg,el.vml.image.fill.color="none",el.vml.color.shape.style.backgroundColor=elStyle.backgroundColor,el.runtimeStyle.backgroundImage="none",el.runtimeStyle.backgroundColor="transparent"}},vmlOffsets:function(el){var thisStyle,size,fudge,makeVisible,bg,bgR,dC,altC,b,c,v;if(thisStyle=el.currentStyle,size={W:el.clientWidth+1,H:el.clientHeight+1,w:this.imgSize[el.vmlBg].width,h:this.imgSize[el.vmlBg].height,L:el.offsetLeft,T:el.offsetTop,bLW:el.clientLeft,bTW:el.clientTop},fudge=size.L+size.bLW==1?1:0,makeVisible=function(vml,l,t,w,h,o){vml.coordsize=w+","+h,vml.coordorigin=o+","+o,vml.path="m0,0l"+w+",0l"+w+","+h+"l0,"+h+" xe",vml.style.width=w+"px",vml.style.height=h+"px",vml.style.left=l+"px",vml.style.top=t+"px"},makeVisible(el.vml.color.shape,size.L+(el.isImg?0:size.bLW),size.T+(el.isImg?0:size.bTW),size.W-1,size.H-1,0),makeVisible(el.vml.image.shape,size.L+size.bLW,size.T+size.bTW,size.W,size.H,1),bg={X:0,Y:0},el.isImg)bg.X=parseInt(thisStyle.paddingLeft,10)+1,bg.Y=parseInt(thisStyle.paddingTop,10)+1;else for(b in bg)bg.hasOwnProperty(b)&&this.figurePercentage(bg,size,b,thisStyle["backgroundPosition"+b]);el.vml.image.fill.position=bg.X/size.W+","+bg.Y/size.H,bgR=thisStyle.backgroundRepeat,dC={T:1,R:size.W+fudge,B:size.H,L:1+fudge},altC={X:{b1:"L",b2:"R",d:"W"},Y:{b1:"T",b2:"B",d:"H"}},"repeat"!=bgR||el.isImg?(c={T:bg.Y,R:bg.X+size.w,B:bg.Y+size.h,L:bg.X},-1!=bgR.search("repeat-")&&(v=bgR.split("repeat-")[1].toUpperCase(),c[altC[v].b1]=1,c[altC[v].b2]=size[altC[v].d]),c.B>size.H&&(c.B=size.H),el.vml.image.shape.style.clip="rect("+c.T+"px "+(c.R+fudge)+"px "+c.B+"px "+(c.L+fudge)+"px)"):el.vml.image.shape.style.clip="rect("+dC.T+"px "+dC.R+"px "+dC.B+"px "+dC.L+"px)"},figurePercentage:function(bg,size,axis,position){var horizontal,fraction;switch(fraction=!0,horizontal="X"==axis,position){case"left":case"top":bg[axis]=0;break;case"center":bg[axis]=.5;break;case"right":case"bottom":bg[axis]=1;break;default:-1!=position.search("%")?bg[axis]=parseInt(position,10)/100:fraction=!1}return bg[axis]=Math.ceil(fraction?size[horizontal?"W":"H"]*bg[axis]-size[horizontal?"w":"h"]*bg[axis]:parseInt(position,10)),bg[axis]%2===0&&bg[axis]++,bg[axis]},fixPng:function(el){el.style.behavior="none";var lib,els,nodeStr,v,e;if("BODY"!=el.nodeName&&"TD"!=el.nodeName&&"TR"!=el.nodeName){if(el.isImg=!1,"IMG"==el.nodeName){if(-1==el.src.toLowerCase().search(/\.png$/))return;el.isImg=!0,el.style.visibility="hidden"}else if(-1==el.currentStyle.backgroundImage.toLowerCase().search(".png"))return;lib=DD_belatedPNG,el.vml={color:{},image:{}},els={shape:{},fill:{}};for(v in el.vml)if(el.vml.hasOwnProperty(v)){for(e in els)els.hasOwnProperty(e)&&(nodeStr=lib.ns+":"+e,el.vml[v][e]=document.createElement(nodeStr));el.vml[v].shape.stroked=!1,el.vml[v].shape.appendChild(el.vml[v].fill),el.parentNode.insertBefore(el.vml[v].shape,el)}el.vml.image.shape.fillcolor="none",el.vml.image.fill.type="tile",el.vml.color.fill.on=!1,lib.attachHandlers(el),lib.giveLayout(el),lib.giveLayout(el.offsetParent),el.vmlInitiated=!0,lib.applyVML(el)}}};try{document.execCommand("BackgroundImageCache",!1,!0)}catch(r){}DD_belatedPNG.createVmlNameSpace(),DD_belatedPNG.createVmlStyleSheet();
